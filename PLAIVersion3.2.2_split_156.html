<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Unknown</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="stylesheet.css"/>
<link rel="stylesheet" type="text/css" href="page_styles.css"/>
</head>
  <body class="c">
<h2 class="c27" id="h.6x2nx4ia71fv"><span class="c4">Tracing Laziness</span></h2><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c4">Another way to understand laziness is to study the encoding of streams in the Stacker. Here is the code:</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c41">#lang stacker/smol/hof</span></p><p class="c3"><span class="c41"></span></p><p class="c5"><span class="c41">(deffun (lz-first s) (left s))</span></p><p class="c5"><span class="c41">(deffun (lz-rest s) ((right s)))</span></p><p class="c5"><span class="c41">(deffun (take n s)</span></p><p class="c5"><span class="c41">  (if (equal? n 0)</span></p><p class="c5"><span class="c41">      empty</span></p><p class="c5"><span class="c41">      (cons (lz-first s) (take (- n 1) (lz-rest s)))))</span></p><p class="c3"><span class="c41"></span></p><p class="c5"><span class="c41">(defvar ones (mpair 1 (λ () ones)))</span></p><p class="c3"><span class="c41"></span></p><p class="c5"><span class="c41">(deffun (nats-from n)</span></p><p class="c5"><span class="c41">  (mpair n (λ () (nats-from (+ n 1)))))</span></p><p class="c5"><span class="c41">(defvar nats (nats-from 0))</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c4">Now run each of</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c41">(take 3 ones)</span></p><p class="c5"><span class="c41">(take 3 nats)</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="calibre3">and study </span><span class="c7">when</span><span class="calibre3"> evaluation happens and </span><span class="c7">what is being held on to by the closures</span><span class="calibre3">. (You may find it helpful to view just one of these at a time: the definition and use of </span><span class="c28">ones</span><span class="calibre3">, and separately of </span><span class="c28">nats</span><span class="calibre3"> and </span><span class="c28">nats-from</span><span class="c4">.)</span></p></body></html>
