<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Unknown</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="stylesheet.css"/>
<link rel="stylesheet" type="text/css" href="page_styles.css"/>
</head>
  <body class="c">
<h2 class="c27" id="h.mfmgpx4ry0f0"><span class="c4">GUIs through Callbacks</span></h2><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c4">To do so, it helps to remind ourselves of the evaluation model in most graphical applications, these days embodied by JavaScript. Suppose we want to make a Web page with a timer that counts up every second, and whose value resets when we click on a Reset button:</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="calibre39"><img alt="" src="image24.png" title="" class="calibre40"/></span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c4">One version of the JavaScript code would look as follows:</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c41">&lt;script type="text/javascript"&gt;</span></p><p class="c5"><span class="c41">var timerID = null;</span></p><p class="c5"><span class="c41">var elapsedTime = 0;</span></p><p class="c3"><span class="c41"></span></p><p class="c5"><span class="c41">function doEverySecond() {</span></p><p class="c5"><span class="c41">  elapsedTime += 1;</span></p><p class="c5"><span class="c41">  document.getElementById('curTime').innerHTML = elapsedTime; }</span></p><p class="c5"><span class="c41">function startTimer() {</span></p><p class="c5"><span class="c41">  timerId = setInterval(doEverySecond, 1000); }</span></p><p class="c5"><span class="c41">function resetElapsed() {</span></p><p class="c5"><span class="c41">  elapsedTime = 0; }</span></p><p class="c5"><span class="c41">&lt;/script&gt;</span></p><p class="c3"><span class="c41"></span></p><p class="c5"><span class="c41">&lt;body onload="startTimer()"&gt;</span></p><p class="c5"><span class="c41">  &lt;center&gt;Elapsed time&lt;/center&gt;</span></p><p class="c5"><span class="c41">  &lt;center&gt;</span></p><p class="c5"><span class="c41">    &lt;div id='curTime'&gt;&amp;nbsp;&lt;/div&gt;</span></p><p class="c5"><span class="c41">  &lt;/center&gt;</span></p><p class="c5"><span class="c41">  &lt;center&gt;</span></p><p class="c5"><span class="c41">    &lt;input id="reset" type="button" value="Reset" onclick="resetElapsed()" /&gt;</span></p><p class="c5"><span class="c41">  &lt;/center&gt;</span></p><p class="c5"><span class="c41">&lt;/body&gt;</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c4">There are three parts to the logic here:</span></p><p class="c3"><span class="c4"></span></p><ol class="c154" start="1"><li class="c155 pcalibre24"><span class="c4">Updating the elapsed time every second.</span></li><li class="c155 pcalibre24"><span class="c4">Resetting the timer on a button-press.</span></li><li class="c155 pcalibre24"><span class="c4">Initiating the computation.</span></li></ol><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c4">These are accomplished as follows:</span></p><p class="c3"><span class="c4"></span></p><ol class="c156" start="1"><li class="pcalibre25 c157"><span class="calibre3">When loaded, the Web page invokes </span><span class="c28">startTimer</span><span class="c4">. </span></li><li class="pcalibre25 c157"><span class="calibre3">We use </span><span class="c28">elapsedTime</span><span class="calibre3"> to record how much time has elapsed, and create a timer, referenced by </span><span class="c28">timerID</span><span class="calibre3">. This installs a timer (and records a reference to it in case we need it later, which we don’t in this program) that runs every second (1000 milliseconds). Whenever the timer goes off, it invokes the function </span><span class="c28">doEverySecond</span><span class="c4">. That function increments the elapsed time, and writes the current value into the Web page.</span></li><li class="pcalibre25 c157"><span class="calibre3">Finally, the reset button has </span><span class="c28">resetElapsed</span><span class="calibre3"> as its callback. This resets the value of </span><span class="c28">elapsedTime</span><span class="c4">, whose updated value is then shown the next time the display is updated. (In principle, we might want to update the display in this callback too.)</span></li></ol><p class="c3"><span class="c4"></span></p><p class="c5"><span class="calibre3">Let us suppose we were given this program to maintain. We want to ask a simple question: what is the value of the Web page’s </span><span class="c28">curTime</span><span class="c4"> element? Observe the reasoning we have to perform:</span></p><ul class="c24"><li class="pcalibre3 c25"><span class="calibre3">It is set inside </span><span class="c28">doEverySecond</span><span class="c4">.</span></li><li class="pcalibre3 c25"><span class="calibre3">It’s set to the value of </span><span class="c28">elapsedTime</span><span class="c4">.</span></li><li class="pcalibre3 c25"><span class="c4">That value is incremented in the previous statement.</span></li><li class="pcalibre3 c25"><span class="calibre3">That increment takes place every time </span><span class="c28">doEverySecond</span><span class="c4"> is called.</span></li><li class="pcalibre3 c25"><span class="calibre3">That call takes place in the first argument of </span><span class="c28">setInterval</span><span class="c4">.</span></li><li class="pcalibre3 c25"><span class="calibre3">That event is installed by </span><span class="c28">startTimer</span><span class="c4">.</span></li><li class="pcalibre3 c25"><span class="c4">Which is called on page load.</span></li><li class="pcalibre3 c25"><span class="calibre3">Wait. We also need to know the initial value, where </span><span class="c28">elapsedTime</span><span class="c4"> is declared.</span></li><li class="pcalibre3 c25"><span class="c4">Oh, but wait. We also see it reset.</span></li><li class="pcalibre3 c25"><span class="calibre3">That happens inside </span><span class="c28">resetElapsed</span><span class="c4">.</span></li><li class="pcalibre3 c25"><span class="c4">Which is called when the button is clicked.</span></li></ul><p class="c5"><span class="c4">In short, we have to follow all this:</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="calibre41"><img alt="" src="image19.png" title="" class="calibre42"/></span></p></body></html>
