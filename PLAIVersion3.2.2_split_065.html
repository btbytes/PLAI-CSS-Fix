<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Unknown</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="stylesheet.css"/>
<link rel="stylesheet" type="text/css" href="page_styles.css"/>
</head>
  <body class="c">
<h2 class="c27" id="h.g95sgdh0td7p"><span class="c4">A Macro Definition Peril</span></h2><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c4">However, this macro contains a subtle (almost hidden), important peril. Consider this example:</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c28">(or-2 (print "hello") "not found")</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="calibre3">That also returns a truthy value, but now we see the print </span><span class="c7">twice</span><span class="c4">. So we need</span></p><p class="c3"><span class="c4"></span></p><p class="c5"><span class="c41">(define-syntax or-2</span></p><p class="c5"><span class="c41">  (syntax-rules ()</span></p><p class="c5"><span class="c41">    [(_ e1 e2)</span></p><p class="c5"><span class="c41">     (let ([v e1])</span></p><p class="c5"><span class="c41">       (if v v e2))]))</span></p><p class="c3"><span class="c4"></span></p><p class="c31"><span class="c40">Exercise:</span><span class="c4"> Confirm that this produces the correct answer.</span></p></body></html>
